diff --git a/0002-nano-system-wide-rcfile-compat.patch b/0002-nano-system-wide-rcfile-compat.patch
new file mode 100644
index 0000000000..e69de29bb2
diff --git a/src/rcfile.c b/src/rcfile.c
index 6143f5fc6f..d139f473f9 100644
--- a/src/rcfile.c
+++ b/src/rcfile.c
@@ -1732,8 +1732,18 @@
 		nanorc = get_full_path(custom_nanorc);
 		if (nanorc == NULL || access(nanorc, F_OK) != 0)
 			die(_("Specified rcfile does not exist\n"));
-	} else
-		nanorc = mallocstrcpy(nanorc, SYSCONFDIR "/nanorc");
+	} else {
+		/* For the system-wide nanorc file, use SYSCONFDIR if defined
+		 * at compile time; otherwise, use %ALLUSERSPROFILE%\nanorc. */
+		if (SYSCONFDIR[0] != '\0') {
+			nanorc = mallocstrcpy(nanorc, SYSCONFDIR "/nanorc");
+		} else {
+			const char *programdata = getenv("ALLUSERSPROFILE");
+			if (programdata == NULL || programdata[0] == '\0')
+				programdata = "C:/ProgramData";
+			nanorc = concatenate(programdata, "/nanorc");
+		}
+	}
 
 	if (is_good_file(nanorc))
 		parse_one_nanorc();
